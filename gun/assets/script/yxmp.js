!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=44)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o=r.RuntimeType.Wechat!==r.getRuntimeType(),i=function(){function e(){}return e._debug_=!0,e.setDebug=function(e){o=e},e.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];o&&console.log.apply(console,["SDK:",e].concat(t))},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(0),i=n(14),a="_user_id",u="_user_token",s=!1,c=[],f=function(){function e(){}return e.getUserId=function(){return r.getStorageData(a)},e.getUserOpenId=function(){return r.getSessionData("_user_openid")},e.setUserOpenId=function(e){r.setSessionData("_user_openid",e)},e.getUserToken=function(){return r.getStorageData(u)},e.getSessionId=function(){var e=r.getStorageData("_user_session");return e||(e=i.randomId(),r.setStorageData("_user_session",e)),e},e.isLoggedIn=function(){return s&&!!r.getStorageData(u)},e.setValid=function(){s||(s=!0,o.default.debug("session.login valid - true",c),c.forEach(function(e){return e(!0)}))},e.login=function(e,t){s=!0,r.setStorageData(a,e),r.setStorageData(u,t),o.default.debug("session.login - true",c),c.forEach(function(e){return e(!0)})},e.logout=function(){s=!1,o.default.debug("session.login - false"),c.forEach(function(e){return e(!1)}),[a,u].forEach(function(e){return r.removeStorageData(e)})},e.registerSessionChangeCallback=function(e){o.default.debug("register session callback"),-1===c.indexOf(e)&&c.push(e)},e.unregisterSessionChangeCallback=function(e){var t=c.indexOf(e);-1!==t&&c.splice(t,1)},e}();t.default=f,t.waitLogin=function(){return f.isLoggedIn()?Promise.resolve():new Promise(function(e){var t=function(n){n?(f.unregisterSessionChangeCallback(t),e()):o.default.debug("!!!warn!!! login callback registered in logged in status")};f.registerSessionChangeCallback(t)})}},function(e,t,n){"use strict";t.__esModule=!0,n(15);var r=void 0;"undefined"==typeof Promise?(r=n(37).Promise,"undefined"!=typeof window&&(window.Promise=r)):r=Promise,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(10),i=n(1),a=[],u={sdk_version:o.getVersion(),session_id:i.default.getSessionId()},s={interval:5};function c(){var e=a.splice(0);e.length>0&&r.default.reportAnalytics(u,e).catch(function(){a.push.apply(a,e)})}var f=null;function l(e){return Object.keys(e).filter(function(t){return void 0!==e[t]}).reduce(function(t,n){return t[n]=e[n],t},{})}var d=function(){function e(){}return e.config=function(e){void 0===e&&(e={}),Object.assign(s,e)},e.setCommonParams=function(e){void 0===e&&(e={}),Object.assign(u,l(e))},e.event=function(e,t){void 0===t&&(t={}),a.push(Object.assign({},{event_id:e,event_time:Math.floor(Date.now()/1e3)},l(t))),function(){if(!f){var e=s.interval;f=setTimeout(function(){c(),f=null},1e3*e)}}()},e.flush=c,e.ReportOptions=s,e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(6),i=n(1),a=n(0),u=n(13),s=n(7),c=n(2),f="_api_server_url",l="_api_app_name";function d(){return r.getSessionData(l)}t.initApi=function(e,t){return r.setSessionData(f,e),r.setSessionData(l,t),c.default.resolve()};var p=o.promisify(wx.request);function g(e,t){var n=""+r.getSessionData(f)+e;t.url=n;var o={"Content-Type":"application/json","X-App-Name":d()},s=i.default.getUserToken();return s&&(o.Authorization="Bearer "+s),t.header=Object.assign({},o,t.header),u.onReady().then(function(){return p(t)}).then(function(e){if(e.data&&0===e.data.code)return a.default.debug("request:success",{url:n,res:e}),e.data;throw e}).catch(function(e){throw a.default.debug("request:fail",{url:n,err:e}),e.data&&16===e.data.code&&a.default.debug("---------- SDK TOKEN INVALID ----------"),e})}function v(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),g(e,{method:"POST",data:t,header:n})}function h(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),g(s.appendQueryParams(e,t),{method:"GET",header:n})}var y=function(){function e(){}return e.getServerTime=function(){return g("/v1/server_time",{method:"GET"})},e.login=function(e){return v("/passport/v1/login_via_code",{code:e})},e.setUserInfo=function(e,t){return v("/passport/v1/wechat/user_info",{encrypted_data:e,iv:t})},e.getUserInfo=function(){return h("/passport/v1/user/me")},e.createBindToken=function(){return v("/passport/v1/bind/token")},e.bindToToken=function(e){return v("/passport/v1/bind/token/"+e)},e.msgSecCheck=function(e){return v("/wechat/v1/msg_sec_check",{content:e})},e.saveFormId=function(e){return v("/wechat/v1/form_id",{form_id:e})},e.decryptShareInfo=function(e,t){return v("/wechat/v1/share_info",{encrypted_data:e,iv:t})},e.createQrCode=function(e){return v("/wechat/v1/qrcode",e)},e.createQrCodeUnlimit=function(e){return v("/wechat/v1/qrcode_unlimit",e)},e.setCloudData=function(e){return v("/data/v1/set_kv_list",{kv_data_list:e})},e.getCloudData=function(e){return v("/data/v1/get_kv_list",{key_list:e})},e.removeCloudData=function(e){return v("/data/v1/remove_kv_list",{key_list:e})},e.incrGlobalData=function(e){return v("/data/v1/global/incr_kv_list",{kv_data_list:e})},e.getGlobalData=function(e){return v("/data/v1/global/get_kv_list",{key_list:e})},e.removeGlobalData=function(e){return v("/data/v1/global/remove_kv_list",{key_list:e})},e.reportAnalytics=function(e,t){return v("/v1/report",{common:e,events:t})},e.createOauthToken=function(e){return v("/oauth/v1/data/token",{expires_in:e})},e.getOauthTokenInfo=function(e){return h("/oauth/v1/data/token/"+e)},e.getContributorList=function(e){return v("/data/v1/open/get_contributor_list",{app_name_list:e})},e.removeContributorList=function(e){return v("/data/v1/open/remove_contributor_list",{contributor_list:e})},e.getContributorKVList=function(e,t,n,r){return v("/data/v1/open/get_contributor_kv_list",{contributor_list:e,key_list:t,app_name_list:n,include_user_info:r})},e.removeContributorKVList=function(e,t){return v("/data/v1/open/remove_contributor_kv_list",{contributor_list:e,key_list:t})},e.setAuthorKVList=function(e,t){return v("/data/v1/open/set_author_kv_list",{kv_data_list:t},{"X-OAuth-Data-Token":e})},e.getAuthorKVList=function(e,t){return v("/data/v1/open/get_author_kv_list",{key_list:t},{"X-OAuth-Data-Token":e})},e.removeAuthorKVList=function(e,t){return v("/data/v1/open/remove_author_kv_list",{key_list:t},{"X-OAuth-Data-Token":e})},e.getAuthorContributorKVList=function(e,t,n,r){return v("/data/v1/open/get_author_contributor_kv_list",{contributor_list:t,key_list:n,app_name_list:r},{"X-OAuth-Data-Token":e})},e.setRankScore=function(e){return v("/data/v1/set_rank_score",{score:e,enable_region:!0})},e.getRankList=function(e){return v("/data/v1/get_rank_list",{count:e})},e.getRegionRankList=function(e){return v("/data/v1/get_region_rank_list",{count:e})},e.rewardCash=function(e,t,n){return v("/trade/v1/reward/cash",{amount:e,title:t,desc:n})},e.getAssetsCash=function(){return h("/trade/v1/assets/cash")},e.rewardCoin=function(e,t,n){return v("/trade/v1/reward/coin",{amount:e,title:t,desc:n})},e.getAssetsCoin=function(){return h("/trade/v1/assets/coin")},e.withdraw=function(e,t,n,r){return void 0===r&&(r="cash"),v("/trade/v1/withdraw",{amount:e,title:t,desc:n,name:r})},e.withdrawList=function(e,t){return h("/trade/v1/withdraw/list",{page:e,page_size:t})},e.getTradeBook=function(e){return h("/trade/v1/book/"+e)},e.appPostRequest=function(e,t,n){return v("/"+d()+"/"+e,t,n)},e.appGetRequest=function(e,t,n){return h("/"+d()+"/"+e,t,n)},e}();t.default=y},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Browser=0]="Browser",e[e.Devtools=1]="Devtools",e[e.Wechat=2]="Wechat"}(r=t.RuntimeType||(t.RuntimeType={})),function(e){e[e.App=0]="App",e[e.Game=1]="Game"}(o=t.AppType||(t.AppType={}));var i=r.Browser,a=o.App,u={};"undefined"==typeof wx?(i=r.Browser,a=o.Game):(u=wx.getSystemInfoSync(),i="devtools"===u.platform?r.Devtools:r.Wechat,a="undefined"!=typeof GameGlobal?o.Game:o.App),t.getAppType=function(){return a},t.getRuntimeType=function(){return i},t.getSystemInfo=function(){return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.promisify=function(e){return function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return new r.default(function(r,o){e.apply(void 0,[Object.assign({},t,{success:r,fail:o})].concat(n))})}}},function(e,t,n){"use strict";function r(e){return Object.keys(e).map(function(t){var n=e[t];return t+"="+encodeURIComponent(n)}).join("&")}function o(e,t){var n=r(t);return e?n?""+e+(-1===e.indexOf("?")&&-1===e.indexOf("=")?"?":"&")+n:e:n}Object.defineProperty(t,"__esModule",{value:!0}),t.decodeQuery=function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return t[n]=decodeURIComponent(r),t},{})},t.stringifyQuery=r,t.appendQueryParams=o,t.appendRefreshParams=function(e,t){return o(e,{ct:Math.floor(Date.now()/(1e3*t))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=[],i=function(){function e(){}return e.register=function(e){o.push(e)},e.init=function(e,t){r.default.debug("plugin manager init");var n=o.map(function(n){return(n.init(e,t)||Promise.resolve()).then(function(){var t,r=n.getPublicInterface&&n.getPublicInterface();r&&Object.assign(e.plugin,((t={})[n.name]=r,t))})});return Promise.all(n)},e.onAppShow=function(e,t){o.filter(function(e){return!!e.onAppShow}).forEach(function(n){return n.onAppShow(e,t)})},e.onAppHide=function(){o.filter(function(e){return!!e.onAppHide}).forEach(function(e){return e.onAppHide()})},e.onShareAppMessage=function(e){return o.filter(function(e){return!!e.onShareAppMessage}).reduce(function(e,t){return t.onShareAppMessage(e)},e)},e.onNewUserRegister=function(e){o.filter(function(e){return!!e.onNewUserRegister}).forEach(function(t){return t.onNewUserRegister(e)})},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};function o(e){return function(t){return!r.hasOwnProperty(t)&&e&&(r[t]=wx.getStorageSync(t)),r[t]}}function i(e){return function(t,n){r[t]=n,e&&wx.setStorage({key:t,data:n})}}function a(e){return function(t){delete r[t],e&&wx.removeStorage({key:t})}}t.getStorageData=o(!0),t.getSessionData=o(!1),t.setStorageData=i(!0),t.setSessionData=i(!1),t.removeStorageData=a(!0),t.removeSessionData=a(!1)},function(e,t,n){"use strict";function r(e){var t=parseInt(e,10);return isNaN(t)?0:t}Object.defineProperty(t,"__esModule",{value:!0}),t.getVersion=function(){return"0.4.9"},t.compareVersion=function(e,t){for(var n=e.split("."),o=t.split("."),i=Math.max(n.length,o.length),a=0;a<i;a++){var u=n[a],s=o[a];if(u!==s){var c=r(u),f=r(s);if(c!==f)return c<f?-1:1}}return 0}},function(e,t,n){"use strict";t.__esModule=!0;t.success=function(e,t){e.success&&e.success(t),e.complete&&e.complete(t)},t.fail=function(e,t){e.fail&&e.fail(t),e.complete&&e.complete(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addHook=function(e,t,n,r){void 0===r&&(r=!1);var o=e[t];(o||r)&&(o&&(o=o.bind(e)),Object.defineProperty(e,t,{value:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n.apply(void 0,[e,t,o].concat(r))},enumerable:!0,writable:!0,configurable:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2),i=!1,a=null,u=new o.default(function(e){a=e});t.onReady=function(){return i?o.default.resolve():u},t.setReady=function(){r.default.debug("setReady..."),i||(i=!0,a(),a=null,u=null)}},function(e,t,n){"use strict";function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function o(e,t){void 0===t&&(t=0);var n=e+1-t;return Math.floor(Math.random()*n)+t}Object.defineProperty(t,"__esModule",{value:!0}),t.randomGUID=r,t.randomId=function(){return r().replace(/-/g,"")},t.randomInt=o,t.randomItem=function(e){return e[o(e.length-1)]},t.removeItem=function(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},function(e,t,n){"use strict";var r=n(5),o=(0,r.getRuntimeType)();(0,r.getAppType)()===r.AppType.Game&&(o===r.RuntimeType.Browser&&(window.GameGlobal=window),"undefined"==typeof window&&(GameGlobal.window=GameGlobal,window.self=window,window.parent=window,window.window=window,window.global=window),"undefined"==typeof wx&&(window.wx={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(4);t.tryBind=function(e,t){var n=e.bind;n&&o.waitLogin().then(function(){return r.default.debug("try bind account..."),i.default.bindToToken(n)}).then(function(){r.default.debug("bind account success")}).catch(function(e){r.default.debug("bind account failed",e)})};var a=function(){return function(){}}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(9),i=n(1),a=n(0),u=n(2),s=n(8),c=n(19),f="_user_channel",l="user-channel",d="#";function p(e){void 0===e&&(e="");var t=e.split(d),n=t[0],r=t[1],o=t[2],i=t[3],a=t[4];return{id:n=n||"0",scene:r=r?parseInt(r):0,gen:o=o?parseInt(o):1,material:i=i||"0",inviter:a=a||"0"}}function g(e){return["id","scene","gen","material","inviter"].map(function(t){return e[t]}).join(d)}var v=function(){function e(){}return e.init=function(e,t){a.default.debug("channel init: ",e,t);var n,d=p(e.channel);d.scene=d.scene||t,a.default.debug("active channel data:",d),r.default.setCommonParams({channel_active:d.id}),(n=o.getStorageData(f),n?(a.default.debug("channel data on cache: ",n),u.default.resolve(p(n))):i.waitLogin().then(function(){var e=c.getCloudData();return e.onReady.then(function(){var t=e.get(l);return t?(a.default.debug("channel data on server: ",t),p(t)):null})})).then(function(e){if(e)return e;a.default.debug("register channel data:",d),s.default.onNewUserRegister(d);var t=c.getCloudData();return t.onReady.then(function(){t.set(l,g(d))}),d}).then(function(e){a.default.debug("channel source: ",e),r.default.setCommonParams({channel_id:e.id,channel_scene:e.scene,channel_gen:e.gen,channel_material:e.material,channel_inviter_id:e.inviter}),o.setSessionData(l,e),o.setStorageData(f,g(e))})},e.getShareQuery=function(e){var t=o.getSessionData(l);if(!t)return{};var n=Object.assign({},t,{gen:t.gen+1,material:e||"0",inviter:i.default.getUserId()});a.default.debug("channel data on share: ",n);var r=g(n);return a.default.debug("channel value on share: ",r),{channel:r}},e}();t.default=v},function(e,t,n){"use strict";function r(){return Math.floor(Date.now()/1e3)}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnixTimestamp=r;var o=r();t.onAppShow=function(){o=r()},t.getElapsedTime=function(){return r()-o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(14),i=n(1),a=n(0),u=3;var s=function(){function e(){this._valueByKey={},this._toBeUpdatedKeys=[],this._toBeRemovedKeys=[],this._updateTimeout=null,this._isReady=!1,this._dirtyKeys=[],this._leftRetryTimes=u,this.refresh()}return e.prototype.keys=function(){return Object.keys(this._valueByKey)},e.prototype.get=function(e,t){var n=this._valueByKey[e];if(void 0===n)return t;if("string"!=typeof n)return n;switch(void 0!==t?typeof t:function(e){try{return typeof JSON.parse(e)}catch(n){var t=parseFloat(e);return isNaN(t)||t+""!==e?"string":"number"}}(n)){case"boolean":return function(e){return"true"===e}(n);case"number":return function(e){try{return JSON.parse(e)}catch(t){return parseFloat(e)}}(n);case"object":return function(e){try{return JSON.parse(e)}catch(e){return null}}(n)}return n},e.prototype.set=function(e,t){t!==this._valueByKey[e]&&(this._valueByKey[e]=t,this._onKeyDirty(e),this._removePendingKey(e),this._toBeUpdatedKeys.push(e),this._setDeferUpdate())},e.prototype.remove=function(e){this._valueByKey.hasOwnProperty(e)&&(delete this._valueByKey[e],this._onKeyDirty(e),this._removePendingKey(e),this._toBeRemovedKeys.push(e),this._setDeferUpdate())},e.prototype.clear=function(){var e=this;this.keys().forEach(function(t){return e.remove(t)})},e.prototype.refresh=function(){var e=this;return this._isReady=!1,this.onReady=i.waitLogin().then(function(){return r.default.getCloudData(["*"])}).then(function(t){e._leftRetryTimes=u;var n=t.data;n&&(n.forEach(function(t){var n=t.key,r=t.value;e._dirtyKeys.includes(n)||e._toBeUpdatedKeys.includes(n)||e._toBeRemovedKeys.includes(n)||(e._valueByKey[n]=r)}),e._isReady=!0,e._dirtyKeys.length=0)}).catch(function(t){throw a.default.debug("cloud data refresh failed. ",t),e._leftRetryTimes>0&&(e._leftRetryTimes-=1,e.refresh()),t}),this.onReady},e.prototype.flush=function(){this._update()},e.prototype._removePendingKey=function(e){o.removeItem(this._toBeRemovedKeys,e),o.removeItem(this._toBeUpdatedKeys,e)},e.prototype._setDeferUpdate=function(){var e=this;i.waitLogin().then(function(){e._updateTimeout||(e._updateTimeout=setTimeout(function(){e._update()},1e3))})},e.prototype._onKeyDirty=function(e){this._isReady||-1===this._dirtyKeys.indexOf(e)&&this._dirtyKeys.push(e)},e.prototype._update=function(){var e=this;clearTimeout(this._updateTimeout),this._updateTimeout=null,this._toBeUpdatedKeys.length>0&&(r.default.setCloudData(this._toBeUpdatedKeys.map(function(t){return{key:t,value:e._valueByKey[t]}})),this._toBeUpdatedKeys.length=0),this._toBeRemovedKeys.length>0&&(r.default.removeCloudData(this._toBeRemovedKeys),this._toBeRemovedKeys.length=0)},e}(),c=null;t.getCloudData=function(){return c||(c=new s),c}},function(e,t,n){"use strict";t.__esModule=!0,t.getWxApiObject=function(){return v},n(15);var r=n(5),o=n(41),i=n(40),a=n(11),u=n(39),s=n(38);function c(e){return function(t){return(0,a.success)(t,Object.assign({errMsg:"ok"},e))}}function f(e){return function(t){return(0,a.fail)(t,Object.assign({errMsg:"fail"},e))}}function l(){}var d={postMessage:l,canvas:(0,i.createCanvas)()},p={createCanvas:i.createCanvas,createImage:i.createImage,onShow:l,offShow:l,onHide:l,offHide:l,setKeepScreenOn:l,vibrateShort:l,vibrateLong:l,downloadFile:l,request:o.request,connectSocket:s.connectSocket,checkSession:c({errMsg:"checkSession:ok"}),login:c({errMsg:"login:ok",code:"MOCK_CODE_"+(window&&window.location&&window.location.search?window.location.search.substr(1):"")}),getUserInfo:f({errMsg:"getUserInfo:fail"}),onMessage:l,getOpenDataContext:function(){return d},openCustomerServiceConversation:l,navigateToMiniProgram:f({errMsg:"navigateToMiniProgram:fail"}),navigateBackMiniProgram:f({errMsg:"navigateBackMiniProgram:fail"}),onShareAppMessage:l,shareAppMessage:l,setEnableDebug:l,setStorage:u.setStorage,getStorage:u.getStorage,getStorageInfo:u.getStorageInfo,clearStorage:u.clearStorage,removeStorage:u.removeStorage,setStorageSync:u.setStorageSync,getStorageSync:u.getStorageSync,getStorageInfoSync:u.getStorageInfoSync,clearStorageSync:u.clearStorageSync,removeStorageSync:u.removeStorageSync,previewImage:l,chooseImage:l,saveImageToPhotosAlbum:l,showToast:l,hideToast:l,showLoading:l,hideLoading:l,showModal:l,showActionSheet:l},g=[s.forcePolyfillConnectSocket?"connectSocket":""];var v=void 0;switch((0,r.getAppType)()){case r.AppType.App:v=wx;break;case r.AppType.Game:"undefined"!=typeof window&&(v=window.wx)}v&&Object.keys(p).forEach(function(e){v.hasOwnProperty(e)&&!function(e){return-1!==g.indexOf(e)}(e)||Object.defineProperty(v,e,{value:p[e],enumerable:!0,writable:!0,configurable:!0})})},,,,,function(e,t,n){"use strict";var r=n(5),o=n(12),i=n(18),a=n(7),u=d(n(0)),s=d(n(3)),c=d(n(17)),f=n(16),l=d(n(8));function d(e){return e&&e.__esModule?e:{default:e}}r.AppType.Game===(0,r.getAppType)()&&(wx.onShow(function(e){u.default.debug("wx.onShow",e),(0,i.onAppShow)();var t=e.query,n=e.scene;n=n||0,t=(0,a.decodeQuery)(t),s.default.event("a_1000_1002",{path:(0,a.stringifyQuery)(t),scene:n}),c.default.init(t,n),(0,f.tryBind)(t,n),l.default.onAppShow(t,n),s.default.flush()}),wx.onHide(function(){s.default.event("a_1000_1003",{duration:(0,i.getElapsedTime)()}),l.default.onAppHide(),s.default.flush()}),(0,o.addHook)(wx,"onShareAppMessage",function(e,t,n,r){n(function(){u.default.debug("onShareAppMessage...");var e=l.default.onShareAppMessage(r.apply(void 0,arguments)),t=e.title,n=e.imageUrl,o=e.query,i=e.success,f=e.fail,d=e.entry,p=e.material;return s.default.event("a_1000_2001",{entry:d,material:p}),{title:t,imageUrl:n,query:(0,a.appendQueryParams)(o,c.default.getShareQuery(p)),success:function(e){u.default.debug("onShareAppMessage: share success: ",e),s.default.event("a_1000_2002",{entry:d,material:p}),i&&i(e)},fail:function(e){u.default.debug("onShareAppMessage: share fail: ",e),s.default.event("a_1000_2003",{entry:d,material:p}),f&&f(e)}}})}),(0,o.addHook)(wx,"shareAppMessage",function(e,t,n,r){u.default.debug("shareAppMessage...");var o=l.default.onShareAppMessage(r),i=o.title,f=o.imageUrl,d=o.query,p=o.success,g=o.fail,v=o.entry,h=o.material;s.default.event("a_1000_2001",{entry:v,material:h}),n({title:i,imageUrl:f,query:(0,a.appendQueryParams)(d,c.default.getShareQuery(h)),success:function(e){u.default.debug("shareAppMessage: share success: ",e),s.default.event("a_1000_2002",{entry:v,material:h}),p&&p(e)},fail:function(e){u.default.debug("shareAppMessage: share fail: ",e),s.default.event("a_1000_2003",{entry:v,material:h}),g&&g(e)}})}),(0,o.addHook)(wx,"openCustomerServiceConversation",function(e,t,n,r){return s.default.event("a_1000_3001"),n(r)}))},function(e,t,n){"use strict";var r=n(5),o=n(12),i=n(18),a=n(7),u=d(n(0)),s=d(n(3)),c=d(n(17)),f=n(16),l=d(n(8));function d(e){return e&&e.__esModule?e:{default:e}}!function(){if(r.AppType.App===(0,r.getAppType)()){if("undefined"!=typeof App){var e=App;App=function(t){(0,o.addHook)(t,"onLaunch",function(e,t,n){for(var r=arguments.length,o=Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];return s.default.event("a_1000_1001"),n.apply(void 0,o)}),(0,o.addHook)(t,"onShow",function(e,t,n,r){u.default.debug("wx.onShow",r),(0,i.onAppShow)();var o=r.path,d=r.query,p=r.scene;p=p||0,d=(0,a.decodeQuery)(d),s.default.event("a_1000_1002",{path:(0,a.appendQueryParams)(o,d),scene:p}),c.default.init(d,p),(0,f.tryBind)(d,p),l.default.onAppShow(d,p),n&&n(r),s.default.flush()},!0),(0,o.addHook)(t,"onHide",function(e,t,n){for(var r=arguments.length,o=Array(r>3?r-3:0),a=3;a<r;a++)o[a-3]=arguments[a];s.default.event("a_1000_1003",{duration:(0,i.getElapsedTime)()}),l.default.onAppHide(),n&&n.apply(void 0,o),s.default.flush()},!0),e(t)}}if("undefined"!=typeof Page){var t=Page;Page=function(e){(0,o.addHook)(e,"onShareAppMessage",function(e,t,n){for(var r=arguments.length,o=Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];u.default.debug("onShareAppMessage...");var f=l.default.onShareAppMessage(n.apply(void 0,o)),d=f.title,p=f.imageUrl,g=f.path,v=f.success,h=f.fail,y=f.entry,_=f.material;return s.default.event("a_1000_2001",{entry:y,material:_}),{title:d,imageUrl:p,path:(0,a.appendQueryParams)(g,c.default.getShareQuery(_)),success:function(e){u.default.debug("onShareAppMessage: share success: ",e),s.default.event("a_1000_2002",{entry:y,material:_}),v&&v(e)},fail:function(e){u.default.debug("onShareAppMessage: share fail: ",e),s.default.event("a_1000_2003",{entry:y,material:_}),h&&h(e)}}}),t(e)}}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(26),n(25);var r=n(12),o=n(0),i=n(3);r.addHook(wx,"navigateToMiniProgram",function(e,t,n,r){var a=r.appId,u=r.success,s=r.fail;return o.default.debug("navigateToMiniProgram..."),i.default.event("a_1000_4001",{app_id:a}),n(Object.assign({},r,{success:function(e){o.default.debug("navigateToMiniProgram success: ",e),i.default.event("a_1000_4002",{app_id:a}),u&&u(e)},fail:function(e){o.default.debug("navigateToMiniProgram fail: ",e),i.default.event("a_1000_4003",{app_id:a}),s&&s(e)}}))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(2),i=n(1),a=n(0);!function(e){e[e.CLOSE=8]="CLOSE",e[e.PING=9]="PING",e[e.PONG=10]="PONG",e[e.LOGIN=11]="LOGIN",e[e.LOGIN_OK=12]="LOGIN_OK",e[e.LOGIN_FAILED=13]="LOGIN_FAILED",e[e.JOIN=21]="JOIN",e[e.JOIN_OK=22]="JOIN_OK",e[e.JOIN_FAILED=23]="JOIN_FAILED",e[e.LEAVE=31]="LEAVE"}(r||(r={}));var u,s,c,f,l,d,p=3,g=10,v=!1;function h(){l=function(){},d=function(){}}h();var y=function(){},_=function(){},m={},b={};function w(e,t,n){if(void 0===t&&(t={}),void 0===n&&(n=!1),f&&(v||n)){var r=JSON.stringify({cmd:e,pt:JSON.stringify(t)});f.send({data:r})}}function S(){f&&f.close(),v=!1,!1}function k(){S(),a.default.debug("websocket.connect..."),!0,v=!1,(f=wx.connectSocket({url:u})).onOpen(P),f.onClose(j),f.onError(D),f.onMessage(C),M()}function O(){if(c<=0)return a.default.debug("websocket connect failed, no retry times left"),d(),void h();a.default.debug("websocket reconnect..."),c-=1,k()}function A(){a.default.debug("websocket heartbeat timeout."),v&&_(),O()}b[r.CLOSE]=S;var T=null;function M(){clearTimeout(T),T=setTimeout(A,1e3*g)}b[r.PONG]=function(){c=s,M()};var x=null;function I(){w(r.PING),clearTimeout(x),x=setTimeout(I,1e3*p)}function P(){var e;!1,e=i.default.getUserToken(),a.default.debug("websocket.login...",e),w(r.LOGIN,{token:e},!0),M()}function j(){!1,v=!1,_()}function D(){a.default.debug("websocket error"),v||(d(),h())}function C(e){var t=e.data;try{var n=JSON.parse(t);if(!n||!n.cmd)return;var r=n.cmd,o=n.pt,i=m[r],u=b[r];if(!i&&!u)return void a.default.debug("websocket unhandled cmd",r,o);var s=o?JSON.parse(o):{};if(i)if(i(s))return;u&&u(s)}catch(e){a.default.debug("websocket error in handle message",e,t)}}b[r.LOGIN_OK]=function(){a.default.debug("websocket.login success."),v=!0,I(),l(),y(),h()},b[r.LOGIN_FAILED]=function(){a.default.debug("websocket.login failed."),clearTimeout(T),O()},t.initWebSocket=function(e){u=e.url,s=e.autoRetryTimes||0};var U=function(){function e(){}return e.connect=function(){return c=s,k(),new o.default(function(e,t){v?e():(l=e,d=t)})},e.close=function(){S()},e.send=function(e,t){w(e,t,!1)},e.onCommand=function(e,t){m[e]=t},e.onConnectionReady=function(e){y=e},e.onConnectionLost=function(e){_=e},e}();t.default=U},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(6),i=n(0),a=n(13),u=n(10),s=n(7),c=n(14),f="_asset_server_url",l="_asset_cms_setting";function d(){return r.getSessionData(l)}t.initAsset=function(e,t,n){var o=e+"/"+n+(t?"/beta":"");return r.setSessionData(f,o),g("/cms_setting.json",300).then(function(e){r.setSessionData(l,e)}).catch(function(e){i.default.debug("failed to get cms setting",e),r.setSessionData(l,{})})};var p=o.promisify(wx.request);function g(e,t){var n=s.appendRefreshParams(""+r.getSessionData(f)+e,t);return a.onReady().then(function(){return p({url:n,method:"GET"})}).then(function(e){if(e.data)return i.default.debug("request:success",{url:n,res:e}),e.data;throw e})}var v=function(){function e(){}return e.fetch=function(e,t){return void 0===t&&(t=300),g(e,t)},e.isVersionOnline=function(e){var t=d();return!(!t||!t.version)&&-1!==u.compareVersion(t.version,e)},e.getShareMessage=function(e,t){var n=d();if(!n||!n.share)return{};var r=n.share,o=r.creatives,a=r.covers;if(!o)return{};var u=c.randomItem(o.filter(function(e){return e.type===t}));if(u||void 0===t||(i.default.debug("no share message for type: "+t+", try default..."),u=c.randomItem(o.filter(function(e){return void 0===e.type}))),!u)return{};var s,f=u.id||"";if(a)if(u.covers){var l=c.randomItem(u.covers);s=a.find(function(e){return e.id===l})}else s=c.randomItem(a);var p=s&&s.id||"";return{title:u.title,imageUrl:s&&s.url,query:"",path:"",entry:e,material:f+"_"+p}},e.getRecommendApp=function(e){var t=d();if(t&&t.recommend){var n=t.recommend,r=n.enabled,o=n.list;if(r&&o){var i=o.filter(function(t){return t.position===e});return c.randomItem(i)}}},e.getCmsSettingItem=function(e){var t=d();if(t&&t.column)return t.column[e]},e.getCmsSetting=d,e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(0),i=n(3),a=n(4),u=n(2),s=r.promisify(wx.getUserInfo);function c(e){var t=e.encryptedData,n=e.iv;return t&&n?a.default.setUserInfo(t,n).then(function(){i.default.event("a_1000_1025"),o.default.debug("api.setUserInfo success")}).catch(function(e){throw i.default.event("a_1000_1024"),o.default.debug("api.setUserInfo fail",e),e}):(i.default.event("a_1000_1023"),o.default.debug("no encrypted data - api.setUserInfo skip"),u.default.reject())}t.getUserInfo=function(){o.default.debug("wx.getUserInfo ..."),i.default.event("a_1000_1021");var e={};return s({withCredentials:!0}).catch(function(e){throw i.default.event("a_1000_1023"),o.default.debug("wx.getUserInfo fail",e),e}).then(function(t){i.default.event("a_1000_1022"),o.default.debug("wx.getUserInfo success",t),e=t.userInfo,c(t)}).then(function(){return e})},t.bindGetUserInfo=function(e){var t=e.detail||e;return o.default.debug("wx.getUserInfo callback",t),c(t),t.userInfo}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(1),i=n(0),a=n(3),u=n(4),s=n(2),c=r.promisify(wx.checkSession);t.checkSession=function(){return o.default.getUserToken()?(i.default.debug("wx.checkSession ..."),s.default.all([c(),u.default.getUserInfo()]).then(function(e){i.default.debug("wx.checkSession session valid"),a.default.event("a_1000_1031");var t=e[1];o.default.setUserOpenId(t.data.open_id),o.default.setValid()}).catch(function(e){throw i.default.debug("wx.checkSession session expired"),o.default.logout(),e})):(i.default.debug("checkSession not logged in"),s.default.reject())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(1),i=n(0),a=n(3),u=n(4),s=r.promisify(wx.login);t.login=function(){return i.default.debug("wx.login ..."),a.default.event("a_1000_1011"),s().catch(function(e){throw i.default.debug("wx.login failed",e),a.default.event("a_1000_1013"),e}).then(function(e){return i.default.debug("wx.login success",e),i.default.debug("api.login ..."),u.default.login(e.code).catch(function(e){throw i.default.debug("api.login failed",e),a.default.event("a_1000_1014"),e})}).then(function(e){i.default.debug("api.login success",e),a.default.event("a_1000_1012");var t=e.data.user||{},n=t.open_id||"";o.default.setUserOpenId(n);var r=t.id||"",u=e.data.token;o.default.login(r,u)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32),o=n(31),i=n(30),a=function(){function e(){}return e.login=r.login,e.checkSession=o.checkSession,e.getUserInfo=i.getUserInfo,e.bindGetUserInfo=i.bindGetUserInfo,e.postMessageToOpenDataContext=function(e,t){void 0===t&&(t={}),wx.getOpenDataContext().postMessage({action:e,data:t})},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),i=n(10),a=n(13),u=n(5),s=n(7),c=n(6),f=n(2),l=n(20),d=n(33),p=n(4),g=n(29),v=n(3),h=n(8),y=n(28),_=n(19);n(27);var m=function(){function e(){}return e.init=function(t){if(void 0!==t.debug){r.default.setDebug(t.debug);var n=l.getWxApiObject();n&&Object.defineProperty(n,"yxmp",{value:e,enumerable:!0,writable:!0,configurable:!0})}r.default.debug("init - version: "+i.getVersion());var u=[],s=p.initApi(t.serverUrl,t.appName);u.push(s);var c=g.initAsset(t.asset.server,t.asset.beta,t.appName);u.push(c);var _=o.default.getUserId();_&&v.default.setCommonParams({user_id:_}),a.setReady(),t.webSocket&&y.initWebSocket(t.webSocket);var m=d.default.checkSession().catch(function(){return d.default.login()}).then(function(){var e=o.default.getUserId();r.default.debug("user: "+e),v.default.setCommonParams({user_id:e})});return u.push(m),f.default.all(u).then(function(t){return h.default.init(e,{Promise:f.default,logger:r.default})}).catch(function(e){throw v.default.event("a_1000_9001",{err:e}),e})},e.getUserId=function(){return o.default.getUserId()},e.getUserOpenId=function(){return o.default.getUserOpenId()},e.registerPlugin=function(e){h.default.register(e)},e.getAppType=u.getAppType,e.getRuntimeType=u.getRuntimeType,e.wx=d.default,e.report=v.default,e.api=p.default,e.asset=g.default,e.websocket=y.default,e.getCloudData=_.getCloudData,e.plugin={},e.utils={promisify:c.promisify,appendQueryParams:s.appendQueryParams},e}();t.default=m},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,c=[],f=!1,l=-1;function d(){f&&s&&(f=!1,s.length?c=s.concat(c):l=-1,c.length&&p())}function p(){if(!f){var e=u(d);f=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new g(e,t)),1!==c.length||f||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,a=void 0,u=function(e,t){g[o]=e,g[o+1]=t,2===(o+=2)&&(a?a(v):b())};var s="undefined"!=typeof window?window:void 0,c=s||{},f=c.MutationObserver||c.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(v,1)}}var g=new Array(1e3);function v(){for(var e=0;e<o;e+=2){(0,g[e])(g[e+1]),g[e]=void 0,g[e+1]=void 0}o=0}var h,y,_,m,b=void 0;function w(e,t){var n=this,r=new this.constructor(O);void 0===r[k]&&N(r);var o=n._state;if(o){var i=arguments[o-1];u(function(){return K(o,r,i,n._result)})}else E(n,r,e,t);return r}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(O);return j(t,e),t}l?b=function(){return t.nextTick(v)}:f?(y=0,_=new f(v),m=document.createTextNode(""),_.observe(m,{characterData:!0}),b=function(){m.data=y=++y%2}):d?((h=new MessageChannel).port1.onmessage=v,b=function(){return h.port2.postMessage(0)}):b=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(v)}:p()}catch(e){return p()}}():p();var k=Math.random().toString(36).substring(2);function O(){}var A=void 0,T=1,M=2,x={error:null};function I(e){try{return e.then}catch(e){return x.error=e,x}}function P(t,n,r){n.constructor===t.constructor&&r===w&&n.constructor.resolve===S?function(e,t){t._state===T?C(e,t._result):t._state===M?U(e,t._result):E(t,void 0,function(t){return j(e,t)},function(t){return U(e,t)})}(t,n):r===x?(U(t,x.error),x.error=null):void 0===r?C(t,n):e(r)?function(e,t,n){u(function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?j(e,n):C(e,n))},function(t){r||(r=!0,U(e,t))},e._label);!r&&o&&(r=!0,U(e,o))},e)}(t,n,r):C(t,n)}function j(e,t){var n,r;e===t?U(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?C(e,t):P(e,t,I(t)))}function D(e){e._onerror&&e._onerror(e._result),R(e)}function C(e,t){e._state===A&&(e._result=t,e._state=T,0!==e._subscribers.length&&u(R,e))}function U(e,t){e._state===A&&(e._state=M,e._result=t,u(D,e))}function E(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+T]=n,o[i+M]=r,0===i&&e._state&&u(R,e)}function R(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?K(n,r,o,i):o(i);e._subscribers.length=0}}function K(t,n,r,o){var i=e(r),a=void 0,u=void 0,s=void 0,c=void 0;if(i){if((a=function(e,t){try{return e(t)}catch(e){return x.error=e,x}}(r,o))===x?(c=!0,u=a.error,a.error=null):s=!0,n===a)return void U(n,new TypeError("A promises callback cannot return that same promise."))}else a=o,s=!0;n._state!==A||(i&&s?j(n,a):c?U(n,u):t===T?C(n,a):t===M&&U(n,a))}var L=0;function N(e){e[k]=L++,e._state=void 0,e._result=void 0,e._subscribers=[]}var G=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(O),this.promise[k]||N(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&C(this.promise,this._result))):U(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===S){var o=I(e);if(o===w&&e._state!==A)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===B){var i=new n(O);P(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===A&&(this._remaining--,e===M?U(r,n):this._result[t]=n),0===this._remaining&&C(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;E(e,void 0,function(e){return n._settledAt(T,t,e)},function(e){return n._settledAt(M,t,e)})},e}();var B=function(){function e(t){this[k]=L++,this._result=this._state=void 0,this._subscribers=[],O!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){j(e,t)},function(t){U(e,t)})}catch(t){U(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return B.prototype.then=w,B.all=function(e){return new G(this,e).promise},B.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},B.resolve=S,B.reject=function(e){var t=new this(O);return U(t,e),t},B._setScheduler=function(e){a=e},B._setAsap=function(e){u=e},B._asap=u,B.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=B},B.Promise=B,B},e.exports=r()}).call(this,n(36),n(35))},function(e,t,n){"use strict";t.__esModule=!0,t.forcePolyfillConnectSocket=void 0,t.connectSocket=function(e){if(!s)return void(0,i.fail)(e,{errMsg:"connectSocket:fail"});return new s(e)};var r=n(5),o=n(10),i=n(11);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=Object.freeze({OPEN:1}),s=void 0;if((0,r.getRuntimeType)()===r.RuntimeType.Browser&&"undefined"!=typeof WebSocket)s=function(){function e(t){a(this,e);var n=t.url;this._ws=new WebSocket(n),(0,i.success)(t,{errMsg:"websocket:ok"})}return e.prototype.send=function(e){if(this._ws.readyState===u.OPEN){var t=e.data;this._ws.send(t),(0,i.success)(e)}else(0,i.fail)(e,{errMsg:"send:websocket is not ready"})},e.prototype.close=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.code,n=e.reason;this._ws.close(t,n),(0,i.success)(e)},e.prototype.onOpen=function(e){this._ws.onopen=e},e.prototype.onClose=function(e){this._ws.onclose=e},e.prototype.onError=function(e){this._ws.onerror=e},e.prototype.onMessage=function(e){this._ws.onmessage=e},e}();else{var c=(0,r.getSystemInfo)().SDKVersion;if(!c||-1===(0,o.compareVersion)(c,"1.7.0")){var f=wx,l=f.connectSocket,d=f.sendSocketMessage,p=f.closeSocket,g=f.onSocketOpen,v=f.onSocketClose,h=f.onSocketError,y=f.onSocketMessage;s=function(){function e(t){a(this,e),l(t)}return e.prototype.send=function(e){d(e)},e.prototype.close=function(e){p(e)},e.prototype.onOpen=function(e){g(e)},e.prototype.onClose=function(e){v(e)},e.prototype.onError=function(e){h(e)},e.prototype.onMessage=function(e){y(e)},e}()}}t.forcePolyfillConnectSocket=!!s},function(e,t,n){"use strict";t.__esModule=!0,t.clearStorageSync=t.removeStorageSync=t.getStorageInfoSync=t.getStorageSync=t.setStorageSync=t.clearStorage=t.removeStorage=t.getStorageInfo=t.getStorage=t.setStorage=void 0;var r=n(11),o=(t.setStorage=function(e){c(e.key,e.data),(0,r.success)(e)},t.getStorage=function(e){(0,r.success)(e,{data:f(e.key)})},t.getStorageInfo=function(e){l(e.key),(0,r.success)(e)},t.removeStorage=function(e){l(e.key),(0,r.success)(e)},t.clearStorage=function(e){d(),(0,r.success)(e)},{}),i=function(e,t){o[e]=t},a=function(e){return o[e]},u=function(e){delete o[e]},s=function(){Object.keys(o).forEach(function(e){delete o[e]})},c=t.setStorageSync=function(e,t){i(e,t)},f=t.getStorageSync=function(e){return a(e)},l=(t.getStorageInfoSync=function(e){return{}},t.removeStorageSync=function(e){u(e)}),d=t.clearStorageSync=function(){s()}},function(e,t,n){"use strict";t.__esModule=!0,t.createImage=function(){try{return new Image}catch(e){return{}}},t.createCanvas=function(){try{return document.createElement("canvas")}catch(e){return{}}}},function(e,t,n){"use strict";t.__esModule=!0,t.request=void 0;var r=n(11);t.request=function(){var e={};arguments.length>0&&(e=arguments.length<=0?void 0:arguments[0]);var t=e.method||"GET",n=e.url||"",o=e.header||{},i=e.data||{},a=new XMLHttpRequest;if(a.open(t.toUpperCase(),n,!0),o)for(var u in o)a.setRequestHeader(u,o[u]);return a.onreadystatechange=function(){if(4==a.readyState){var t=a.getAllResponseHeaders(),n={};if(t)t.split("\n").forEach(function(e){if(e){var t=e.split(": ");t.length>1&&(n[t[0]]=t[1])}});if(a.status>=200&&a.status<300){var o={errMsg:"request:ok"};try{var i=JSON.parse(a.response);o.data=i}catch(e){o.data=a.response}o.header=n,(0,r.success)(e,o)}else(0,r.fail)(e,{errMsg:"request:fail",data:a.response,header:n})}},a.send(JSON.stringify(i)),a}},function(e,t,n){"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var o,i,a=0|t,u=Math.max(a>=0?a:r-Math.abs(a),0);for(;u<r;){if((o=n[u])===(i=e)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;u++}return!1}})},function(e,t,n){"use strict";n(15),n(42),n(20)},function(e,t,n){"use strict";n(43);var r=i(n(2)),o=i(n(34));function i(e){return e&&e.__esModule?e:{default:e}}"undefined"!=typeof window&&(window.yxmp=o.default),e.exports={yxmp:o.default,Promise:r.default}}])});
//# sourceMappingURL=yxmp.js.map